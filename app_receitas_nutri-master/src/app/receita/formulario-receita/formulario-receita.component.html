<div class="container mt-4">
  <h2>{{modoEdicao ? 'Editar Receita' : 'Nova Receita'}}</h2>
  
  <form [formGroup]="formulario" (ngSubmit)="onSubmit()">
    <!-- Informações Básicas -->
    <div class="row mb-4">
      <div class="col-md-8">
        <div class="mb-3">
          <label class="form-label">Título</label>
          <input type="text" 
                 class="form-control" 
                 formControlName="titulo"
                 [class.is-invalid]="formulario.get('titulo')?.invalid && formulario.get('titulo')?.touched">
          <div class="invalid-feedback">Título é obrigatório</div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="mb-3">
          <label class="form-label">Horário</label>
          <select class="form-select" formControlName="horario">
            <option value="Café da manhã">Café da manhã</option>
            <option value="Lanche da manhã">Lanche da manhã</option>
            <option value="Almoço">Almoço</option>
            <option value="Lanche da tarde">Lanche da tarde</option>
            <option value="Jantar">Jantar</option>
            <option value="Ceia">Ceia</option>
          </select>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="mb-3">
          <label class="form-label">Tempo (minutos)</label>
          <input type="number" 
                 class="form-control" 
                 formControlName="tempo"
                 [class.is-invalid]="formulario.get('tempo')?.invalid && formulario.get('tempo')?.touched">
          <div class="invalid-feedback">Tempo deve ser maior que 0</div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="mb-3">
          <label class="form-label">Rendimento (porções)</label>
          <input type="number" 
                 class="form-control" 
                 formControlName="rendimento"
                 [class.is-invalid]="formulario.get('rendimento')?.invalid && formulario.get('rendimento')?.touched">
          <div class="invalid-feedback">Rendimento deve ser maior que 0</div>
        </div>
      </div>
    </div>
    
    <!-- Ingredientes -->
    <div class="mb-4">
      <h4>Ingredientes</h4>
      
      <div formArrayName="ingredientes">
        <div *ngFor="let item of ingredientesForm.controls; let i = index" class="mb-3 p-3 border rounded">
          <div [formGroupName]="i" class="row g-2">
            <div class="col-md-6">
              <select class="form-select" formControlName="idIngrediente"
                      [class.is-invalid]="ingredientesForm.at(i).get('idIngrediente')?.invalid && ingredientesForm.at(i).get('idIngrediente')?.touched">
                <option value="">Selecione um ingrediente</option>
                <option *ngFor="let ingrediente of ingredientes" [value]="ingrediente.idIngrediente">
                  {{ingrediente.descricao}}
                </option>
              </select>
              <div class="invalid-feedback">Selecione um ingrediente</div>
            </div>
            
            <div class="col-md-4">
              <input type="number" 
                     step="0.1"
                     class="form-control" 
                     formControlName="quantidade"
                     [class.is-invalid]="ingredientesForm.at(i).get('quantidade')?.invalid && ingredientesForm.at(i).get('quantidade')?.touched">
              <div class="invalid-feedback">Quantidade deve ser maior que 0</div>
            </div>
            
            <div class="col-md-2">
              <button type="button" class="btn btn-danger w-100" (click)="removerIngrediente(i)">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <button type="button" class="btn btn-secondary" (click)="adicionarIngrediente()">
        <i class="bi bi-plus"></i> Adicionar Ingrediente
      </button>
    </div>
    
    <!-- Modo de Preparo -->
    <div class="mb-4">
      <h4>Modo de Preparo</h4>
      <textarea class="form-control" 
                rows="6" 
                formControlName="preparo"
                [class.is-invalid]="formulario.get('preparo')?.invalid && formulario.get('preparo')?.touched"></textarea>
      <div class="invalid-feedback">Modo de preparo é obrigatório</div>
      <div class="form-text">
        Separe cada passo em uma nova linha
      </div>
    </div>
    
    <!-- Botões -->
    <div class="d-grid gap-2 d-md-flex">
      <button type="submit" class="btn btn-primary">
        {{modoEdicao ? 'Atualizar Receita' : 'Criar Receita'}}
      </button>
      <button type="button" class="btn btn-outline-secondary" routerLink="/receitas">
        Cancelar
      </button>
    </div>
  </form>
</div>
